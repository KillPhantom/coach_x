<!-- å­¦å‘˜åˆ—è¡¨é¡µé¢ -->
<view class="header" style="padding-top: {{statusBarHeight}}px;">
  å­¦å‘˜ç®¡ç†
</view>

<view class="container container-with-tabs">
  <!-- æœç´¢ä¸è¿‡æ»¤ -->
  <view class="search-filter">
    <input type="text" placeholder="æœç´¢å­¦å‘˜..." class="search-input" bindinput="onSearchInput" />
    <picker bindchange="onFilterChange" value="{{filterIndex}}" range="{{filterOptions}}">
      <view class="filter-select">
        {{filterOptions[filterIndex]}}
      </view>
    </picker>
  </view>
  
  <!-- å­¦å‘˜ç»Ÿè®¡ -->
  <view class="stat-cards">
    <view wx:if="{{loading.stats}}" class="loading-container">
      <view class="loading-text">åŠ è½½ä¸­...</view>
    </view>
    <view wx:else class="stat-cards-content">
      <view class="stat-card {{filterIndex === 0 ? 'selected' : ''}}" bindtap="filterByType" data-type="all">
        <view class="stat-number">{{stats.total}}</view>
        <view class="stat-label">æ€»å­¦å‘˜</view>
      </view>
      <view class="stat-card {{filterIndex === 1 ? 'selected' : ''}}" bindtap="filterByType" data-type="active">
        <view class="stat-number">{{stats.active}}</view>
        <view class="stat-label">æ´»è·ƒå­¦å‘˜</view>
      </view>
      <view class="stat-card {{filterIndex === 2 ? 'selected' : ''}}" bindtap="filterByType" data-type="needAttention">
        <view class="stat-number">{{stats.needAttention}}</view>
        <view class="stat-label">éœ€è¦å…³æ³¨</view>
      </view>
    </view>
  </view>
  
  <!-- å­¦å‘˜åˆ—è¡¨æ ‡é¢˜ -->
  <view class="section-header">
    <view class="section-title">æ‰€æœ‰å­¦å‘˜</view>
    <view class="add-btn" bindtap="addNewStudent">
      <text class="add-icon">+</text>æ·»åŠ å­¦å‘˜
    </view>
  </view>
  
  <!-- å­¦å‘˜åˆ—è¡¨ -->
  <scroll-view 
    scroll-y="true" 
    class="student-scroll-view"
    style="height: {{scrollHeight}}px;" 
    bindscrolltolower="onScrollToLower"
    enable-back-to-top="true"
    enhanced="true"
    show-scrollbar="false">
    
    <view wx:if="{{loading.students && !isLoadingMore}}" class="loading-container">
      <view class="loading-text">åŠ è½½ä¸­...</view>
    </view>
    
    <block wx:else>
      <view class="student-card" 
            wx:for="{{students}}" 
            wx:key="id">
        <view class="avatar" style="{{item.avatarStyle}}">{{item.avatar}}</view>
        <view class="student-info">
          <view class="student-name">{{item.name}}</view>
          <view class="student-status" style="{{item.statusStyle}}">{{item.status}}</view>
          <view>
            <text class="tag {{item.tagClass}}">{{item.tag}}</text>
          </view>
        </view>
        <view class="student-actions">
          <text class="action-btn" bindtap="showStudentOptions" data-student-id="{{item.id}}">æ“ä½œ</text>
        </view>
      </view>
      
      <!-- åŠ è½½æ›´å¤šæç¤º -->
      <view wx:if="{{isLoadingMore}}" class="loading-more">
        <view class="loading-text">åŠ è½½æ›´å¤š...</view>
      </view>
      
      <!-- æ²¡æœ‰æ›´å¤šæ•°æ®æç¤º -->
      <view wx:if="{{!pagination.hasMore && students.length > 0}}" class="no-more-data">
        <view class="no-more-text">æ²¡æœ‰æ›´å¤šæ•°æ®äº†</view>
      </view>
      
      <!-- æ²¡æœ‰æ•°æ®æç¤º -->
      <view wx:if="{{!loading.students && students.length === 0}}" class="no-data">
        <view class="no-data-text">æš‚æ— å­¦å‘˜æ•°æ®</view>
      </view>
    </block>
  </scroll-view>
  
  <!-- åº•éƒ¨å¯¼èˆªæ  -->
  <view class="tab-bar">
    <view class="tab {{currentTab === 'assistant' ? 'active' : ''}}" bindtap="switchTab" data-tab="assistant">
      <view class="tab-icon">ğŸ¤–</view>
      <view>AIåŠ©æ‰‹</view>
    </view>
    <view class="tab {{currentTab === 'students' ? 'active' : ''}}" bindtap="switchTab" data-tab="students">
      <view class="tab-icon">ğŸ‘¥</view>
      <view>å­¦å‘˜</view>
    </view>
    <view class="tab {{currentTab === 'training' ? 'active' : ''}}" bindtap="switchTab" data-tab="training">
      <view class="tab-icon">ğŸ“‹</view>
      <view>è®­ç»ƒè®¡åˆ’</view>
    </view>
  </view>
</view> 