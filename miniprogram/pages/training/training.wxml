<!-- æ™ºèƒ½è®­ç»ƒè®¡åˆ’é¡µé¢ -->
<view class="header" style="padding-top: {{statusBarHeight}}px;">
  æ™ºèƒ½è®­ç»ƒè®¡åˆ’
</view>

<view class="container container-with-tabs">
  <view class="content-wrapper">
    
    <!-- æ™ºèƒ½æç¤ºå¡ç‰‡ -->
    <view class="ai-insight">
      <view class="ai-insight-container">
        <view class="ai-insight-icon">
          <text>ğŸ’¡</text>
        </view>
        <view class="ai-insight-content">
          <view class="ai-insight-title">AIè®­ç»ƒè§è§£</view>
          <view class="ai-insight-text">
            <text wx:if="{{loading.aiInsight}}">åŠ è½½ä¸­...</text>
            <text wx:else>{{aiInsight.text}}</text>
          </view>
        </view>
      </view>
      <view class="ai-insight-refresh">
        <button class="refresh-btn" bindtap="refreshInsight">
          <text class="refresh-icon">ğŸ”„</text>é‡æ–°ç”Ÿæˆè§è§£
        </button>
      </view>
    </view>
    
    <!-- æœç´¢ä¸è¿‡æ»¤é€‰é¡¹ -->
    <view class="search-filter">
      <input type="text" placeholder="æœç´¢å­¦å‘˜æˆ–è®¡åˆ’..." class="search-input" bindinput="onSearchInput" />
      <picker bindchange="onFilterChange" value="{{filterIndex}}" range="{{filterOptions}}">
        <view class="filter-select">
          {{filterOptions[filterIndex]}}
        </view>
      </picker>
    </view>
    
    <!-- è®¡åˆ’æ¨¡æ¿ç®¡ç† -->
    <view class="card">
      <view class="card-header">
        <view class="card-title">AIä¼˜åŒ–è®¡åˆ’æ¨¡æ¿</view>
        <button class="ai-create-button" bindtap="createAITemplate">
          <text class="ai-button-icon">ğŸ¤–</text>åˆ›å»ºæ™ºèƒ½æ¨¡æ¿
        </button>
      </view>
      
      <view wx:if="{{loading.templates}}" class="loading-container">
        <view class="loading-text">åŠ è½½ä¸­...</view>
      </view>
      
      <scroll-view wx:else scroll-x="true" class="template-scroll">
        <view class="template-card {{item.optimized ? 'optimized' : ''}}" 
              wx:for="{{templates}}" 
              wx:key="id" 
              bindtap="viewTemplate" 
              data-template-id="{{item.id}}">
          <view class="template-title">{{item.name}}</view>
          <view class="template-frequency">{{item.frequency}}</view>
          <view class="template-usage">ä½¿ç”¨ä¸­: {{item.usageCount}}åå­¦å‘˜</view>
          <view class="template-status {{item.optimized ? 'optimized-status' : 'can-optimize-status'}}">
            {{item.optimized ? 'AIä¼˜åŒ–ç‰ˆæœ¬' : 'å¯ä¼˜åŒ–'}}
          </view>
        </view>
      </scroll-view>
    </view>
    
    <!-- å­¦å‘˜è®¡åˆ’ç®¡ç† -->
    <view class="section-header">
      <view class="section-title">æ‰€æœ‰å­¦å‘˜è®­ç»ƒè®¡åˆ’</view>
    </view>
    
    <view class="plan-list-card">
      <view wx:if="{{loading.studentPlans}}" class="loading-container">
        <view class="loading-text">åŠ è½½ä¸­...</view>
      </view>
      
      <block wx:else>
        <view class="plan-item" wx:for="{{studentPlans}}" wx:key="id">
          <view class="plan-student-info">
            <view class="avatar" style="{{item.avatarStyle}}">{{item.avatar}}</view>
            <view class="student-info-text">
              <view class="student-name">{{item.name}}</view>
              <view class="student-tags">
                <text class="tag {{item.phaseTagClass}}">{{item.phase}}</text>
                <text class="tag">ç¬¬{{item.week}}å‘¨</text>
              </view>
            </view>
          </view>
          <view class="plan-name">
            <text>{{item.planName}}</text>
          </view>
          <view class="plan-actions">
            <button class="plan-action-btn" catchtap="editPlan" data-plan-id="{{item.id}}">ç¼–è¾‘</button>
          </view>
        </view>
      </block>
    </view>
    
    <!-- æ‰¹é‡æ“ä½œæŒ‰é’® -->
    <view class="batch-action-container">
      <button class="batch-action-btn" bindtap="batchOptimize">
        <text class="button-icon">ğŸ¤–</text>æ‰¹é‡AIä¼˜åŒ–è®¡åˆ’
      </button>
    </view>
    
    <!-- åˆ›å»ºæ–°è®¡åˆ’æŒ‰é’® -->
    <view class="add-plan-container">
      <button class="add-plan-btn" bindtap="createNewPlan">
        <text class="add-icon">+</text>åˆ›å»ºæ–°è®¡åˆ’
      </button>
    </view>
  </view>
  
  <!-- åº•éƒ¨å¯¼èˆªæ  -->
  <view class="tab-bar">
    <view class="tab {{currentTab === 'assistant' ? 'active' : ''}}" bindtap="switchTab" data-tab="assistant">
      <view class="tab-icon">ğŸ¤–</view>
      <view>AIåŠ©æ‰‹</view>
    </view>
    <view class="tab {{currentTab === 'students' ? 'active' : ''}}" bindtap="switchTab" data-tab="students">
      <view class="tab-icon">ğŸ‘¥</view>
      <view>å­¦å‘˜</view>
    </view>
    <view class="tab {{currentTab === 'training' ? 'active' : ''}}" bindtap="switchTab" data-tab="training">
      <view class="tab-icon">ğŸ“‹</view>
      <view>è®­ç»ƒè®¡åˆ’</view>
    </view>
  </view>
</view> 