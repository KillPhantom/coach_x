<!-- å­¦ç”Ÿè®­ç»ƒè¯¦æƒ…é¡µé¢ -->
<view class="header" style="padding-top: {{statusBarHeight}}px;">
  <view class="back-button" bindtap="goBack">â†</view>
  è®­ç»ƒè¯¦æƒ…
</view>

<view class="container container-with-tabs">
  <view class="content-wrapper">
    <!-- å­¦å‘˜ä¿¡æ¯éƒ¨åˆ† -->
    <view class="student-header">
      <view class="avatar" style="{{student.avatarStyle}}">{{student.avatar}}</view>
      <view class="student-info">
        <view class="student-name">{{student.name}} - {{student.planName}}</view>
        <view class="student-tags">
          <text class="tag {{student.phaseTagClass}}">{{student.phase}}</text>
          <text class="tag">ç¬¬{{student.week}}å‘¨</text>
        </view>
      </view>
    </view>
    
    <!-- æ—¥æœŸé€‰æ‹©å™¨ -->
    <view class="date-selector">
      <view class="date-nav">
        <view class="date-arrow" bindtap="previousDay">â—€</view>
        <picker mode="date" value="{{selectedDate}}" start="2023-01-01" end="2025-12-31" bindchange="onDateChange">
          <view class="selected-date">
            {{selectedDate}} {{isToday ? '(ä»Šå¤©)' : ''}}
          </view>
        </picker>
        <view class="date-arrow" bindtap="nextDay">â–¶</view>
      </view>
    </view>
    
    <!-- å®Œæˆæƒ…å†µæ¦‚è§ˆ -->
    <view class="completion-overview">
      <view class="completion-item {{trainingCompletion.status}}">
        <view class="completion-icon">ğŸ‹ï¸</view>
        <view class="completion-info">
          <view class="completion-title">è®­ç»ƒåŠ¨ä½œ</view>
          <view class="completion-status">{{trainingCompletion.text}}</view>
        </view>
      </view>
      
      <view class="completion-item {{dietCompletion.status}}">
        <view class="completion-icon">ğŸ½ï¸</view>
        <view class="completion-info">
          <view class="completion-title">é¥®é£Ÿè®¡åˆ’</view>
          <view class="completion-status">{{dietCompletion.text}}</view>
        </view>
      </view>
      
      <view class="completion-item {{supplementCompletion.status}}">
        <view class="completion-icon">ğŸ’Š</view>
        <view class="completion-info">
          <view class="completion-title">è¡¥å‰‚å»ºè®®</view>
          <view class="completion-status">{{supplementCompletion.text}}</view>
        </view>
      </view>
    </view>
    
    <!-- å†…ç½®æ ‡ç­¾é¡µ -->
    <view class="plan-tabs">
      <view class="plan-tab {{activeTab === 'training' ? 'active' : ''}}" bindtap="switchTab" data-tab="training">
        è®­ç»ƒåŠ¨ä½œ
      </view>
      <view class="plan-tab {{activeTab === 'diet' ? 'active' : ''}}" bindtap="switchTab" data-tab="diet">
        é¥®é£Ÿè®¡åˆ’
      </view>
      <view class="plan-tab {{activeTab === 'supplements' ? 'active' : ''}}" bindtap="switchTab" data-tab="supplements">
        è¡¥å‰‚å»ºè®®
      </view>
    </view>

    <!-- è®­ç»ƒåŠ¨ä½œå†…å®¹ - åªè¯»ç‰ˆ -->
    <view class="tab-content" wx:if="{{activeTab === 'training'}}">
      <block wx:if="{{trainingDay}}">
        <view class="plan-day">
          <view class="day-title">
            <view>{{trainingDay.day}} ({{trainingDay.focus}})</view>
          </view>
          
          <view wx:for="{{trainingDay.exercises}}" wx:for-item="exercise" wx:key="name" wx:for-index="exerciseIndex"
                class="workout-item {{exercise.completed ? 'completed' : ''}}">
            <view class="workout-header">
              <view class="workout-name">{{exercise.name}}</view>
              <view class="workout-completion">
                <text class="{{exercise.completed ? 'completed-text' : 'incomplete-text'}}">
                  {{exercise.completed ? 'å·²å®Œæˆ' : 'æœªå®Œæˆ'}}
                </text>
              </view>
            </view>
            
            <!-- æ˜¾ç¤ºç»„æ•°ä¿¡æ¯ -->
            <view class="workout-sets">
              <view class="set-item" wx:for="{{exercise.sets}}" wx:for-item="set" wx:key="index">
                <text class="set-number">ç»„{{index + 1}}:</text>
                <text class="set-weight">{{set.weight}}</text>
                <text class="set-reps">{{set.reps}}</text>
              </view>
            </view>
            
            <view class="workout-note" wx:if="{{exercise.note}}">
              <text class="note-label">å¤‡æ³¨:</text> {{exercise.note}}
            </view>
          </view>
        </view>
      </block>
      <view wx:else class="no-training">
        <view class="no-training-text">ä»Šæ—¥æ— è®­ç»ƒå®‰æ’</view>
      </view>
    </view>

    <!-- é¥®é£Ÿè®¡åˆ’å†…å®¹ - åªè¯»ç‰ˆ -->
    <view class="tab-content" wx:if="{{activeTab === 'diet'}}">
      <view class="macro-nutrients-horizontal">
        <view class="macro-item">
          <view class="macro-value">{{dietPlan.calories}}kcal</view>
          <view class="macro-label">æ€»çƒ­é‡</view>
        </view>
        <view class="macro-item">
          <view class="macro-value">{{dietPlan.protein}}g</view>
          <view class="macro-label">è›‹ç™½è´¨</view>
        </view>
        <view class="macro-item">
          <view class="macro-value">{{dietPlan.carbs}}g</view>
          <view class="macro-label">ç¢³æ°´</view>
        </view>
        <view class="macro-item">
          <view class="macro-value">{{dietPlan.fat}}g</view>
          <view class="macro-label">è„‚è‚ª</view>
        </view>
      </view>
      
      <block wx:for="{{dietPlan.meals}}" wx:key="name" wx:for-item="meal" wx:for-index="mealIndex">
        <view class="meal-container {{meal.completed ? 'completed' : ''}}">
          <view class="meal-header">
            <view class="meal-title">
              <text>{{meal.name}}</text>
              <text wx:if="{{meal.time}}" class="meal-time">{{meal.time}}</text>
            </view>
            <view class="meal-completion">
              <text class="{{meal.completed ? 'completed-text' : 'incomplete-text'}}">
                {{meal.completed ? 'å·²å®Œæˆ' : 'æœªå®Œæˆ'}}
              </text>
            </view>
          </view>
          
          <!-- æ˜¾ç¤ºé£Ÿç‰©ä¿¡æ¯ -->
          <view class="meal-item" wx:for="{{meal.foods}}" wx:for-item="food" wx:key="name">
            <view class="meal-item-content">
              <view class="meal-item-name">{{food.name}}</view>
              <view class="meal-item-amount">{{food.amount}}</view>
            </view>
          </view>
        </view>
      </block>

      <!-- é¥®é£Ÿæ³¨æ„äº‹é¡¹ -->
      <view class="diet-notes" wx:if="{{dietPlan.notes}}">
        <view class="diet-notes-header">
          <view class="diet-notes-title">é¥®é£Ÿæ³¨æ„äº‹é¡¹</view>
        </view>
        <view class="diet-notes-content">{{dietPlan.notes}}</view>
      </view>
    </view>

    <!-- è¡¥å‰‚å»ºè®®å†…å®¹ - ç®€åŒ–ç‰ˆï¼Œåªæ˜¾ç¤ºæ—¶æ®µå®Œæˆæƒ…å†µ -->
    <view class="tab-content" wx:if="{{activeTab === 'supplements'}}">
      <!-- æ—©ä¸Šè¡¥å‰‚ -->
      <view class="supplement-container" wx:if="{{hasMorningSupplements}}">
        <view class="supplement-header">
          <view class="supplement-title">
            <text>æ—©ä¸Š</text>
          </view>
          <view class="supplement-completion">
            <text class="{{morningSupplementsCompleted ? 'completed-text' : 'incomplete-text'}}">
              {{morningSupplementsCompleted ? 'å·²å®Œæˆ' : 'æœªå®Œæˆ'}}
            </text>
          </view>
        </view>
        
        <!-- æ—©ä¸Šè¡¥å‰‚åˆ—è¡¨ -->
        <view class="supplement-list">
          <view wx:for="{{supplements}}" wx:key="name" wx:if="{{item.morning}}">
            {{item.name}} {{item.morning}}
          </view>
        </view>
      </view>
      
      <!-- ä¸­åˆè¡¥å‰‚ -->
      <view class="supplement-container" wx:if="{{hasNoonSupplements}}">
        <view class="supplement-header">
          <view class="supplement-title">
            <text>ä¸­åˆ</text>
          </view>
          <view class="supplement-completion">
            <text class="{{noonSupplementsCompleted ? 'completed-text' : 'incomplete-text'}}">
              {{noonSupplementsCompleted ? 'å·²å®Œæˆ' : 'æœªå®Œæˆ'}}
            </text>
          </view>
        </view>
        
        <!-- ä¸­åˆè¡¥å‰‚åˆ—è¡¨ -->
        <view class="supplement-list">
          <view wx:for="{{supplements}}" wx:key="name" wx:if="{{item.noon}}">
            {{item.name}} {{item.noon}}
          </view>
        </view>
      </view>
      
      <!-- æ™šä¸Šè¡¥å‰‚ -->
      <view class="supplement-container" wx:if="{{hasEveningSupplements}}">
        <view class="supplement-header">
          <view class="supplement-title">
            <text>æ™šä¸Š</text>
          </view>
          <view class="supplement-completion">
            <text class="{{eveningSupplementsCompleted ? 'completed-text' : 'incomplete-text'}}">
              {{eveningSupplementsCompleted ? 'å·²å®Œæˆ' : 'æœªå®Œæˆ'}}
            </text>
          </view>
        </view>
        
        <!-- æ™šä¸Šè¡¥å‰‚åˆ—è¡¨ -->
        <view class="supplement-list">
          <view wx:for="{{supplements}}" wx:key="name" wx:if="{{item.evening}}">
            {{item.name}} {{item.evening}}
          </view>
        </view>
      </view>
    </view>
    
    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-buttons">
      <button class="button button-primary" bindtap="sendFeedback">
        <text class="button-icon">ğŸ’¬</text> å‘é€åé¦ˆ
      </button>
      <button class="button button-outline" bindtap="editPlan">
        <text class="button-icon">âœï¸</text> ç¼–è¾‘è®¡åˆ’
      </button>
    </view>
  </view>

</view> 