<!-- AIåŠ©æ‰‹é¡µé¢ -->
<view class="header" style="padding-top: {{statusBarHeight}}px;">
  CoachX æ™ºèƒ½æ•™ç»ƒåŠ©æ‰‹
</view>

<view class="container container-with-tabs" wx:if="{{currentPage === 'ai-assistant-page'}}">
  <!-- AIåŠŸèƒ½å¡ç‰‡ -->
  <view class="card ai-card">
    <view class="ai-icon-bg">ğŸ¤–</view>
    <view class="ai-title">AIåŠ©æ‰‹</view>

    <view class="ai-button-group">
      <button class="ai-button" bindtap="onAIFeature" data-feature="report" disabled="{{generatingReport}}">
        <text class="ai-button-icon">ğŸ“Š</text>ä¸€é”®ç”Ÿæˆä»Šæ—¥è®­ç»ƒæŠ¥å‘Š
      </button>
      <button class="ai-button" bindtap="onAIFeature" data-feature="analysis">
        <text class="ai-button-icon">ğŸ“‹</text>æ•°æ®åˆ†ææŠ¥å‘Š
      </button>
    </view>

    <view class="ai-last-analysis">
      <text wx:if="{{loading.aiSuggestion}}">åŠ è½½ä¸­...</text>
      <text wx:else>ä¸Šæ¬¡AIåˆ†æ: {{aiSuggestion.timestamp}}</text>
    </view>
  </view>

  <!-- å¿«é€Ÿä¿¡æ¯å¡ç‰‡ -->
  <view class="card">
    <view class="card-header">
      <view class="card-title">ä»Šæ—¥æ¦‚è§ˆ</view>
      <view class="ai-generated">
        <text class="ai-icon">ğŸ¤–</text>AIç”Ÿæˆ
      </view>
    </view>

    <view wx:if="{{loading.dailyStats}}" class="loading-container">
      <view class="loading-text">åŠ è½½ä¸­...</view>
    </view>

    <view wx:else class="stat-row">
      <view class="stat-item">
        <view class="stat-number stat-completed">{{dailyStats.completedTrainings}}</view>
        <view class="stat-label">å·²å®Œæˆè®­ç»ƒ</view>
      </view>
      <view class="stat-item">
        <view class="stat-number stat-warning">{{dailyStats.needReminders}}</view>
        <view class="stat-label">éœ€è¦æé†’</view>
      </view>
      <view class="stat-item">
        <view class="stat-number stat-info">{{dailyStats.plansToUpdate}}</view>
        <view class="stat-label">è®¡åˆ’å¾…æ›´æ–°</view>
      </view>
    </view>

    <view class="ai-suggestion">
      <view class="ai-suggestion-title">
        <text class="ai-suggestion-icon">ğŸ’¡</text>AIå»ºè®®
      </view>
      <view class="ai-suggestion-content">
        <text wx:if="{{loading.aiSuggestion}}">åŠ è½½ä¸­...</text>
        <text wx:else>{{aiSuggestion.content}}</text>
      </view>
    </view>
  </view>

  <!-- éœ€è¦æ³¨æ„çš„å­¦å‘˜ -->
  <view class="section-header">
    <view class="section-title">éœ€è¦æ³¨æ„çš„å­¦å‘˜</view>
    <view class="view-all" bindtap="viewAllStudents">å…¨éƒ¨æŸ¥çœ‹</view>
  </view>

  <view wx:if="{{loading.studentsNeedAttention}}" class="loading-container">
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>

  <block wx:else>
    <view class="student-card warning-student" 
          wx:for="{{studentsNeedAttention}}" 
          wx:key="id"
          bindtap="viewStudentDetail" 
          data-student="{{item.name}}"
          data-student-id="{{item.id}}">
      <view class="avatar warning-avatar">{{item.avatar}}</view>
      <view class="student-info">
        <view class="student-name">{{item.name}}</view>
        <view class="student-status {{item.statusClass}}">{{item.status}}</view>
        <view>
          <text class="tag {{item.tagClass}}">{{item.tag}}</text>
        </view>
      </view>
      <view>
        <button class="ai-action-button" catchtap="remindStudent" data-student="{{item.name}}" data-student-id="{{item.id}}">
          <text class="button-icon">ğŸ””</text>æé†’
        </button>
      </view>
    </view>
  </block>

  <!-- è¡¨ç°ä¼˜ç§€çš„å­¦å‘˜ -->
  <view class="section-header">
    <view class="section-title">è¡¨ç°ä¼˜ç§€çš„å­¦å‘˜</view>
    <view class="view-all" bindtap="viewAllStudents">å…¨éƒ¨æŸ¥çœ‹</view>
  </view>

  <view wx:if="{{loading.excellentStudents}}" class="loading-container">
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>

  <block wx:else>
    <view class="student-card excellent-student" 
          wx:for="{{excellentStudents}}" 
          wx:key="id"
          bindtap="viewStudentDetail" 
          data-student="{{item.name}}"
          data-student-id="{{item.id}}">
      <view class="avatar excellent-avatar">{{item.avatar}}</view>
      <view class="student-info">
        <view class="student-name">{{item.name}}</view>
        <view class="student-status {{item.statusClass}}">{{item.status}}</view>
        <view>
          <text class="tag {{item.tagClass}}">{{item.tag}}</text>
        </view>
      </view>
      <view>
        <button class="ai-action-button excellent-button" catchtap="praiseStudent" data-student="{{item.name}}" data-student-id="{{item.id}}">
          <text class="button-icon">ğŸ‘</text>é¼“åŠ±
        </button>
      </view>
    </view>
  </block>

  <!-- åº•éƒ¨å¯¼èˆªæ  -->
  <view class="tab-bar">
    <view class="tab {{currentTab === 'assistant' ? 'active' : ''}}" bindtap="switchTab" data-tab="assistant">
      <view class="tab-icon">ğŸ¤–</view>
      <view>AIåŠ©æ‰‹</view>
    </view>
    <view class="tab {{currentTab === 'students' ? 'active' : ''}}" bindtap="switchTab" data-tab="students">
      <view class="tab-icon">ğŸ‘¥</view>
      <view>å­¦å‘˜</view>
    </view>
    <view class="tab {{currentTab === 'training' ? 'active' : ''}}" bindtap="switchTab" data-tab="training">
      <view class="tab-icon">ğŸ“‹</view>
      <view>è®­ç»ƒè®¡åˆ’</view>
    </view>
  </view>
</view>

<!-- è®­ç»ƒè®¡åˆ’è¯¦æƒ…é¡µé¢ -->
<view class="container container-with-tabs" wx:if="{{currentPage === 'plan-detail-page'}}">
  <!-- è®­ç»ƒè®¡åˆ’è¯¦æƒ…å†…å®¹ -->
</view>

<!-- å­¦å‘˜åˆ—è¡¨é¡µé¢ -->
<view class="container container-with-tabs" wx:if="{{currentPage === 'students-page'}}">
  <!-- å­¦å‘˜åˆ—è¡¨å†…å®¹ -->
</view>

<!-- å­¦å‘˜è¯¦æƒ…é¡µé¢ -->
<view class="container container-with-tabs" wx:if="{{currentPage === 'student-detail-page'}}">
  <!-- å­¦å‘˜è¯¦æƒ…å†…å®¹ -->
</view>

<!-- è®­ç»ƒè®¡åˆ’é¡µé¢ -->
<view class="container container-with-tabs" wx:if="{{currentPage === 'training-plan-page'}}">
  <!-- è®­ç»ƒè®¡åˆ’å†…å®¹ -->
</view> 