<!-- AIåŠ©æ‰‹é¡µé¢ -->
<view class="header" style="padding-top: {{statusBarHeight}}px;">CoachX æ™ºèƒ½æ•™ç»ƒåŠ©æ‰‹</view>
<view class="container container-with-tabs" wx:if="{{currentPage === 'ai-assistant-page'}}">
  <!-- ä»Šæ—¥æ¦‚è§ˆå¡ç‰‡ - ç°ä»£ç®€æ´è®¾è®¡ -->
  <view class="overview-card">
    <view class="overview-title">ä»Šæ—¥æ¦‚è§ˆ</view>
    <view wx:if="{{loading.dailyStats}}" class="loading-container">
      <view class="loading-text">åŠ è½½ä¸­...</view>
    </view>
    <view wx:else class="overview-stats">
      <view class="stat-item">
        <view class="stat-number completed">{{dailyStats.completedTrainings}}</view>
        <view class="stat-label">å·²å®Œæˆè®­ç»ƒ</view>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <view class="stat-number warning">{{dailyStats.needReminders}}</view>
        <view class="stat-label">éœ€è¦æé†’</view>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <view class="stat-number info">{{dailyStats.plansToUpdate}}</view>
        <view class="stat-label">è®¡åˆ’å¾…æ›´æ–°</view>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <view class="stat-number unread">{{dailyStats.unreadMessages}}</view>
        <view class="stat-label">æœªå›å¤</view>
      </view>
    </view>
    <button class="report-button" bindtap="onAIFeature" data-feature="report" disabled="{{generatingReport}}">
      AIæ€»ç»“æŠ¥å‘Š
    </button>
  </view>

    <!-- éœ€è¦å›å¤çš„å­¦å‘˜ - æ–°å¢éƒ¨åˆ† -->
  <block>
    <view class="section-header">
      <view class="section-title">éœ€è¦å›å¤çš„å­¦å‘˜</view>
    </view>
    <view wx:if="{{loading.studentsNeedReply}}" class="loading-container">
      <view class="loading-text">åŠ è½½ä¸­...</view>
    </view>
    <block wx:else>
      <view class="student-card unread-student" wx:for="{{studentsNeedReply}}" wx:key="id" bindtap="viewStudentMessage" data-student="{{item.name}}" data-studentId="{{item.id}}">
        <view class="avatar unread-avatar">{{item.avatar}}</view>
        <view class="student-info">
          <view class="student-name">{{item.name}}</view>
          <view class="student-status unread-status">{{item.lastMessage}}</view>
          <view class="message-time">{{item.messageTime}}</view>
        </view>
        <view>
          <button class="ai-action-button unread-button" catchtap="replyStudent" data-student="{{item.name}}" data-studentId="{{item.id}}">
            å›å¤
          </button>
        </view>
      </view>
    </block>
  </block>
  <!-- éœ€è¦æ³¨æ„çš„å­¦å‘˜ -->
  <view class="section-header">
    <view class="section-title">éœ€è¦æ³¨æ„çš„å­¦å‘˜</view>
    <view class="remind-all" bindtap="remindAllStudents">ä¸€é”®æé†’</view>
  </view>
  <view wx:if="{{loading.studentsNeedAttention}}" class="loading-container">
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>
  <block wx:else>
    <view class="student-card warning-student" wx:for="{{studentsNeedAttention}}" wx:key="id" bindtap="viewStudentTodayTrainingDetail" data-student="{{item.name}}" data-studentId="{{item.id}}">
      <view class="avatar warning-avatar">{{item.avatar}}</view>
      <view class="student-info">
        <view class="student-name">{{item.name}}</view>
        <view class="student-status {{item.statusClass}}">{{item.status}}</view>
        <view>
          <text class="tag {{item.tagClass}}">{{item.tag}}</text>
        </view>
      </view>
      <view>
        <button class="ai-action-button" catchtap="remindStudent" data-student="{{item.name}}" data-studentId="{{item.id}}">
          <text class="button-icon">ğŸ””</text>
          æé†’
        </button>
      </view>
    </view>
  </block>
  <!-- åº•éƒ¨å¯¼èˆªæ  -->
  <view class="tab-bar">
    <view class="tab {{currentTab === 'assistant' ? 'active' : ''}}" bindtap="switchTab" data-tab="assistant">
      <view class="tab-icon">ğŸ¤–</view>
      <view>AIåŠ©æ‰‹</view>
    </view>
    <view class="tab {{currentTab === 'students' ? 'active' : ''}}" bindtap="switchTab" data-tab="students">
      <view class="tab-icon">ğŸ‘¥</view>
      <view>å­¦å‘˜</view>
    </view>
    <view class="tab {{currentTab === 'training' ? 'active' : ''}}" bindtap="switchTab" data-tab="training">
      <view class="tab-icon">ğŸ“‹</view>
      <view>è®­ç»ƒè®¡åˆ’</view>
    </view>
  </view>
</view>
<!-- è®­ç»ƒè®¡åˆ’è¯¦æƒ…é¡µé¢ -->
<view class="container container-with-tabs" wx:if="{{currentPage === 'plan-detail-page'}}">
  <!-- è®­ç»ƒè®¡åˆ’è¯¦æƒ…å†…å®¹ -->
</view>
<!-- å­¦å‘˜åˆ—è¡¨é¡µé¢ -->
<view class="container container-with-tabs" wx:if="{{currentPage === 'students-page'}}">
  <!-- å­¦å‘˜åˆ—è¡¨å†…å®¹ -->
</view>
<!-- å­¦å‘˜è¯¦æƒ…é¡µé¢ -->
<view class="container container-with-tabs" wx:if="{{currentPage === 'student-detail-page'}}">
  <!-- å­¦å‘˜è¯¦æƒ…å†…å®¹ -->
</view>
<!-- è®­ç»ƒè®¡åˆ’é¡µé¢ -->
<view class="container container-with-tabs" wx:if="{{currentPage === 'training-plan-page'}}">
  <!-- è®­ç»ƒè®¡åˆ’å†…å®¹ -->
</view>